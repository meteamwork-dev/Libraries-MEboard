#include "MEBoard.h"
//Example04 สั่ง %valve AO รีเลย์แชแนลที่ 1 ด้วยอุณหภูมิจาก NTC แชแนลที่ 1

void setup() {
  pinmode(); //ประกาศขาที่จำเป็นต่อใช้งานของ MEBoard
  TimeSensor.setInterval(3000,ReadSensor);  //ความเร็วในการวนอ่านค่าเซ็นเซอร์ ตั้งค่าไว้ 3000 = 3Sec 
  Serial.begin(19200);  //เพื่อดูค่าใน Serial Monitor โดย baud-rate 19200
  slave.begin(9600); //สื่อสาร RS485 ช่องที่ 1 เลือก baud rate 9600
  slave2.begin(9600); //สื่อสาร RS485 ช่องที่ 2 เลือก baud rate 9600
}

void ReadSensor(){
  ReadAI();
/////////////forAIset///////////////////////

//////////////////////////////////////////
}

void loop() {
   TimeSensor.run(); //เปิดใช้งานฟังก์ชั่นเวลา
   ReadDI(); //อ่านค่า DI ทุกแชแนลของ MEBoard
   modbusread(); //อ่านค่าจาก RS485
   Eeprom(); //จดจำค่าตัวแปรเมื่อบอร์ดไม่มีไฟเลี้ยง
   
 /////////////programing here//////////////////
   Serial.println(NTC1); //แสดงค่า NTC แชแนลที่ 1 ใน serial monitor
   if(NTC1 <= 30){ //ถ้าค่าอุณหภูมิ NTC1 น้อยกว่าหรือเท่ากับ 30 องศา
    AOut(1,100); //สั่ง AnalogOutput แชแนลที่ 1 100% 
    } 
   if(NTC1 > 30 && NTC1 < 34){ //ถ้าค่าอุณหภูมิ NTC1 มากกว่า 30 องศา และ ค่าอุณหภูมิ NTC1 น้อยกว่า 34 องศา
    AOut(1,70); //สั่ง AnalogOutput แชแนลที่ 1 70%
    }
   if(NTC1 > 34 && NTC1 < 38){ //ถ้าค่าอุณหภูมิ NTC1 มากกว่า 34 องศา และ ค่าอุณหภูมิ NTC1 น้อยกว่า 38 องศา
    AOut(1,50); //สั่ง AnalogOutput แชแนลที่ 1 50%
   }
   if(NTC1 >= 38){ //ถ้าค่าอุณหภูมิ NTC1 มากกว่าหรือเท่ากับ 38 องศา
    AOut(1,30); //สั่ง AnalogOutput แชแนลที่ 1 30%
    }
 /////////////////////////////////////////////  
   Register();
}
