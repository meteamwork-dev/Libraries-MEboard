#include "MEBoard.h"
//Example03 สั่งเปิด-ปิดรีเลย์แชแนลที่ 1 ด้วยอุณหภูมิจาก AI แชแนลที่ 1

void setup() {
  pinmode(); //ประกาศขาที่จำเป็นต่อใช้งานของ MEBoard
  TimeSensor.setInterval(3000,ReadSensor);  //ความเร็วในการวนอ่านค่าเซ็นเซอร์ ตั้งค่าไว้ 3000 = 3Sec
  Serial.begin(19200);  //เพื่อดูค่าใน Serial Monitor โดย baud-rate 19200
  slave.begin(9600); //สื่อสาร RS485 ช่องที่ 1 เลือก baud rate 9600  
  slave2.begin(9600); //สื่อสาร RS485 ช่องที่ 2 เลือก baud rate 9600 
}

void ReadSensor(){
  ReadAI();
/////////////forAIset///////////////////////
AISet(1,0.1042,-41.354,-20,60,1 ); //เลือกแชแนลที่ 1, ค่า m = 0.1042, ค่า c = -41.354, ค่าน้อยที่สุดของเซนเซอร์คือ -20, ค่ามากที่สุดคือ 60
//////////////////////////////////////////
}

void loop() {
   TimeSensor.run(); //เปิดใช้งานฟังก์ชั่นเวลา
   ReadDI(); //อ่านค่า DI ทุกแชแนลของ MEBoard
   modbusread(); //อ่านค่าจาก RS485
   Eeprom(); //จดจำค่าตัวแปรเมื่อบอร์ดไม่มีไฟเลี้ยง
   Register(); //ประกาศตำแหน่ง RS485 แต่ละตัวแปร
 /////////////programing here//////////////////
   Serial.println(AI1); //แสดงค่า AI1 แชแนลที่ 1 ใน serial monitor
   if(AI1 <= 33){ //ถ้าค่าอุณหภูมิ AI1 น้อยกว่าหรือเท่ากับ 33
      DOut(1,0); //สั่งรีเลย์ Digitaloutput แชแนลที่1 ไม่ทำงาน
   }
   if(AI1 > 33){ //ถ้าค่าอุณหภูมิ AI1 มากกว่า 33
      DOut(1,1); //สั่งรีเลย์ Digitaloutput แชแนลที่1 ทำงาน
   }
    
 /////////////////////////////////////////////  
}

